import json
import hashlib
from apk_download import APK_Download
from apk_parse.apk import APK
from MalwareDetection import EXIT_CODES
from virus_total_apis import PublicApi as VirusTotalPublicApi

API_KEY = 'a7ceb212f39d6a547859c65eb42b4ebacf48f90ea024ed71e5470b47f4688e31'
url = 'http://shouji.360tpcdn.com/160622/96f7b4b431751bd9017e3be62d7b8919/sll.zhuishushenqi.mf_3.apk'


from MalwareDetection import MalwareDetection

TestURL = MalwareDetection()

url_1 = 'https://download.apkpure.com/custom/com.apkpure.aegon-891.apk?_fn=QVBLUHVyZV92MS40LjFfYXBrcHVyZS5jb20uYXBr&k=8d98ff6f480bb2287857038dfdf164e458f8f26b&as=411b70aaea1345e7abb388fa6ad13f5058f64fe3&_p=Y29tLmFwa3B1cmUuYWVnb24%3D&c=1%7CTOOLS&arg=apkpure%3A%2F%2Fcampaign%2F%3Futm_source%3Dapkpure%26utm_medium%3Dhttps%3A%2F%2Fapkpure.com%2Fapkpure%2Fcom.apkpure.aegon%26utm_term%3Da4d'
print "Url 1 test results", EXIT_CODES[TestURL.isMalware(url_1)]
url_2 = 'http://shouji.360tpcdn.com/160622/96f7b4b431751bd9017e3be62d7b8919/sll.zhuishushenqi.mf_3.apk'
print "Url 2 test results", EXIT_CODES[TestURL.isMalware(url_2)]
url_3 = 'http://down.360safe.com/yunpan/360mall_360yunpan_1.apk'
print "Url 3 test results", EXIT_CODES[TestURL.isMalware(url_3)]
url_4 = 'http://down.360safe.com/yunpan/360mall_360yunpan_1.apk?channel_id=foo&timestamp=bar'
print "Url 4 test results", EXIT_CODES[TestURL.isMalware(url_4)]
url_5 = 'http://app.sadl.sogou.com/apks/sogousearch_1303b.apk'
print "Url 5 test results", EXIT_CODES[TestURL.isMalware(url_5)]
url_6 = 'http://dl.appsearch.m.sogou.com/apks/sogousearch_8010.apk'
print "Url 6 test results", EXIT_CODES[TestURL.isMalware(url_6)]
url_7 = 'http://pollux.androidapksfree.com/polluxdata/3f2cb2c93fee574a97bbaa96988b64bf/com.facebook.lite_v34.0.0.13.68-53156713_Android-2.3.apk'
print "Url 7 test results", EXIT_CODES[TestURL.isMalware(url_7)]
url_8 = 'http://pollux.androidapksfree.com/hdata/71dd11434da033dee472484a4e0620ce/com.lenovo.anyshare.gps_v3.8.8_ww-4030808_Android-2.2.apk'
print "Url 8 test results", EXIT_CODES[TestURL.isMalware(url_8)]








