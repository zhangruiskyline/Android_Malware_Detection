import unittest
from MalwareDetection import MalwareDetection, EXIT_CODES

TestURL = MalwareDetection()

class TesMaliciousURLMethods(unittest.TestCase):
    def test_url(self):
        #bad_url_1 = 'download/com.douquhd.xiaotu.apk'
        #self.assertEqual(TestURL.isMalware(bad_url_1), EXIT_CODES.index('isMalware'))
        good_url_2 = 'http://pollux.androidapksfree.com/polluxdata/89b47ec67f93ab18fc30638f52a3a50b/com.whatsapp_v2.17.130-451736_Android-4.0.apk'
        self.assertEqual(TestURL.isMalware(good_url_2), EXIT_CODES.index('isClean'))



if __name__ == '__main__':
    unittest.main()
