import unittest
from MalwareDetection import MalwareDetection, EXIT_CODES

TestURL = MalwareDetection()

class TesMaliciousURLMethods(unittest.TestCase):
    def test_url(self):
        url_1 = 'https://download.apkpure.com/custom/com.apkpure.aegon-891.apk?_fn=QVBLUHVyZV92MS40LjFfYXBrcHVyZS5jb20uYXBr&k=8d98ff6f480bb2287857038dfdf164e458f8f26b&as=411b70aaea1345e7abb388fa6ad13f5058f64fe3&_p=Y29tLmFwa3B1cmUuYWVnb24%3D&c=1%7CTOOLS&arg=apkpure%3A%2F%2Fcampaign%2F%3Futm_source%3Dapkpure%26utm_medium%3Dhttps%3A%2F%2Fapkpure.com%2Fapkpure%2Fcom.apkpure.aegon%26utm_term%3Da4d'
        self.assertEqual(TestURL.isMalware(url_1), EXIT_CODES.index('NotValid'))
        url_2 = 'http://pollux.androidapksfree.com/polluxdata/89b47ec67f93ab18fc30638f52a3a50b/com.whatsapp_v2.17.130-451736_Android-4.0.apk'
        self.assertEqual(TestURL.isMalware(url_2), EXIT_CODES.index('isMalware'))
        url_3 = 'http://shouji.360tpcdn.com/160622/96f7b4b431751bd9017e3be62d7b8919/sll.zhuishushenqi.mf_3.apk'
        self.assertEqual(TestURL.isMalware(url_3), EXIT_CODES.index('isMalware'))
        url_4 = 'http://pollux.androidapksfree.com/hdata/ba138e619e62d5dab879d234b10caf5a/devian.tubemate.home_v2.3.8-707_Android-2.1.apk'
        self.assertEqual(TestURL.isMalware(url_4), EXIT_CODES.index('isMalware'))


if __name__ == '__main__':
    unittest.main()
