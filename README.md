
# File Architecture

* MalwareDetection.py is the main file that contains Class MalwareDetection()

* apk_download.py is to download apk from url link

* apk_parse/ folder is used to parse downloaded apk file

* UrlDB.py is the SQLite database file

* test.py is the unit test file based on Python unit test framework

# Run Application

> First to run UrlDB.py to create the SQLite database and SQLalchemy enginee 

> Business Logic will be:

* Look up in a local  DB to see whether it has any exact match of the url link(remove query). If it does, return the truth from the DB match;
* If it doesn’t find an exact match of the url from step 1, but find an exact match on the name of the APK (case insensitive), fetch the metadata (the size of the APK file to be downloaded) from the url. If the size matches the one in DB, return the truth from the DB match;
* If the size from step 2 doesn’t match, neither APK name matches, download the APK file from the url. If successfully downloaded, calculate the MD5 hash from the APK file and look up the hash in DB. Return truth from DB if a hash matches can be found in DB.
* If it can’t find a hash match from step 3, call Virus Total API (virustotal.com, you can find existing Python module to call Virus Total API on GitHub) to upload the APK file, and fetch the scan result (this has to be asynchronous). Save the scan result to DB and return the scan result.
  
> Return status

['DB_no_connection','VirusTotal_no_connection','isMalware','isClean','NotValid']

* DB_no_connection: Database is not available 
* VirusTotal_no_connection: API call to http://virustotal.com/ dose not respond correctly
* isMalware: APK URL has malicious file
* isClean: APK URL is clean
* NotValid: url link dose not contain apk file

 