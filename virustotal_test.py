import json
import hashlib
import time
from virus_total_apis import PublicApi as VirusTotalPublicApi

API_KEY = 'a7ceb212f39d6a547859c65eb42b4ebacf48f90ea024ed71e5470b47f4688e31'
url = 'http://shouji.360tpcdn.com/160622/96f7b4b431751bd9017e3be62d7b8919/sll.zhuishushenqi.mf_3.apk'

vt_instance = VirusTotalPublicApi(API_KEY)
response =  vt_instance.get_url_report(url)
#print response
if "error" in response and response["error"] is not None:
    print "No connection"



from MalwareDetection import MalwareDetection

TestURL = MalwareDetection()

url_2 = 'http://pollux.androidapksfree.com/polluxdata/89b47ec67f93ab18fc30638f52a3a50b/com.whatsapp_v2.17.130-451736_Android-4.0.apk'
print TestURL.isMalware(url_2)
url_3 = 'http://shouji.360tpcdn.com/160622/96f7b4b431751bd9017e3be62d7b8919/sll.zhuishushenqi.mf_3.apk'
print TestURL.isMalware(url_3)
url_4 = 'http://pollux.androidapksfree.com/hdata/ba138e619e62d5dab879d234b10caf5a/devian.tubemate.home_v2.3.8-707_Android-2.1.apk'
print TestURL.isMalware(url_4)
url_5 = 'http://down.360safe.com/yunpan/360mall_360yunpan_1.apk'
print TestURL.isMalware(url_5)
url_5_query = 'http://down.360safe.com/yunpan/360mall_360yunpan_1.apk?channel_id=foo&timestamp=bar'
print TestURL.isMalware(url_5_query)
url_6 = 'http://ucdl.25pp.com/fs04/2016/02/04/7/102_a77d24abdbf2bc8c5bd5b3792cd4a4a6.apk'
print TestURL.isMalware(url_6)
url_7 = 'http://down.360safe.com/yunpan/360mall_360yunpan_1.apk'
print TestURL.isMalware(url_7)
url_8 = 'http://ucdl.25pp.com/fs04/2016/02/04/7/102_a77d24abdbf2bc8c5bd5b3792cd4a4a6.apk'
print TestURL.isMalware(url_8)


